!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="/compiled/",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){var o,n,a,l,i,s,d,g,c,u,h,y,m,f,p,v,b,C,k,x;o=r(2),x=r(3),L.mapbox.accessToken="pk.eyJ1Ijoiam9yamViYXJyZXJhIiwiYSI6IklWa1JXM1EifQ.BJDcoEfnAsKO7CMvT7CaIw",C=L.latLng(37.7072,-122.5868),p=L.latLng(37.8339,-122.3554),l=L.latLngBounds(C,p),f=L.mapbox.map("map","jorjebarrera.jkli7jo2",{maxBounds:l,maxZoom:20,minZoom:13,attributionControl:!1,zoomControl:!1}),f.fitBounds(l).setView([37.778,-122.426],15),new L.Control.Zoom({position:"bottomright"}).addTo(f),a={"BIKE ROUTE":"3, 3","BIKE LANE":"","BIKE PATH":"5, 10"},n=["#2ECC71","#3498DB","#E74C3C"],u=function(e,t){return{lineCap:"square",weight:3,opacity:1,color:n[t],fillColor:n[t],dashArray:a[e],fillOpacity:.7}},k=L.marker(new L.LatLng(37.7787880226612,-122.42438793182373),{icon:L.mapbox.marker.icon({"marker-color":"#FF8888","marker-symbol":"bicycle"}),draggable:!0}),k.on("click",function(){return console.log(k.getLatLng())}),d=L.marker(new L.LatLng(37.7787880226612,-122.41507530212402),{icon:L.mapbox.marker.icon({"marker-color":"#3498DB","marker-symbol":"bicycle"}),draggable:!0}),k.addTo(f),d.addTo(f),h=L.layerGroup(),h.addTo(f),y=L.layerGroup(),y.addTo(f),m=[],c=function(e,t){var r,o,n,a,l,i,s;for(n=v(t.line1),a=v(t.line2),e=v(e.geometry),s=[n.coordinates[0],a.coordinates[a.coordinates.length-1]],o=l=0,i=s.length;i>l;o=++l)if(r=s[o],x.isEqual(r,e.coordinates[0])||x.isEqual(r,e.coordinates[e.coordinates.length-1]))return{barrier:t.barrier,facilityT:t.facilityT,geometry:t["line"+(o+1)]};return null},s=function(e,t){var r,o;if(null!=t)return r={type:"Feature",geometry:{type:"LineString",coordinates:[[e[0],e[1]],[t[0],t[1]]]}},o=L.geoJson(r,{style:function(){return{fillColor:"#9B59B6",weight:2,opacity:1,color:"#9B59B6",dashArray:"",fillOpacity:.7}}}),o.addTo(f),y.addLayer(o)},g=function(e,t){var r,o,n,a,l,i,s,d,g,c,u;if("Point"===e.geometry.type)return e.geometry.coordinates;for(n=e.geometry.coordinates.length,a=t.geometry.coordinates.length,c=[e.geometry.coordinates[0],e.geometry.coordinates[n-1]],i=0,d=c.length;d>i;i++){for(r=c[i],l=!1,u=[t.geometry.coordinates[0],t.geometry.coordinates[a-1]],s=0,g=u.length;g>s;s++)o=u[s],x.isEqual(r,o)&&(l=!0);if(!l)return r}return null},v=function(e){var t;try{return o.parseJSON(e)}catch(r){return t=r,console.log(t),{}}},b=function(e,t){var r,n,a;null==t&&(t=!1),a=o("#alert"),a.removeClass("hidden").find("div.message").html(e),o("#overlay").removeClass("hidden"),n=a.outerWidth(),r=a.outerHeight(),a.css({marginTop:"-"+r/2+"px",marginLeft:"-"+n/2+"px"}),t&&a.find("button").hide()},i=function(){var e;return e=o("#alert"),e.addClass("hidden").find("button").show(),o("#overlay").addClass("hidden")},o("#close-alert").on("click",function(){i()}),o("div.result").on("click",function(){var e,t,r,n,a,l,i,s,d,g,c,u;if(null!=m&&m.length>0)if(u=o(this),u.toggleClass("shown"),e=u.index(),u.find("i").toggleClass("fa-eye fa-eye-slash"),u.is(".shown"))for(h.clearLayers(),t=[],o("div.result").each(function(e){u=o(this),u.is(".shown")&&t.push(e)}),t.reverse(),n=0,i=t.length;i>n;n++)for(e=t[n],g=m[e],a=0,s=g.length;s>a;a++)r=g[a],h.addLayer(r);else for(c=m[e],l=0,d=c.length;d>l;l++)r=c[l],h.removeLayer(r)}),o("#find-bike-routes").on("click",function(){var e,t,r,n;n=o(this),n.prop("disabled",!0),o("div.results").addClass("hidden"),m=[],h.clearLayers(),y.clearLayers(),r=k.getLatLng(),e=d.getLatLng(),t=o.get("http://sfhired-jorje.rhcloud.com/paths/"+r.lng+"/"+r.lat+"/"+e.lng+"/"+e.lat),b("Finding shortest paths...",!0),t.done(function(t){var a,l,d,y,f,p,C,k,x,T,w,E,B,I,D,F,J,j,q;i();try{if(p=t.paths,null==p)return b("Sorry, no data available. Please try again.<br><em>Note: Try to reverse the markers.</em>"),void n.prop("disabled",!1);for(w=c(p[0],t.startEdge),l=c(p[p.length-1],t.endEdge),C=null,T=[],B=0,F=p.length;F>B;B++)f=p[B],(null===C||C!==f.routeID)&&(T[f.routeID]=[]),T[f.routeID].push({type:"Feature",properties:{"stroke-width":6},geometry:v(f.geometry),style:u(f.facilityT,f.routeID),_length:f.length}),C=f.routeID;for(T.reverse(),x=I=0,J=T.length;J>I;x=++I){for(k=T[x],q=T.length-1-x,E=0,null!=w&&k.unshift({type:"Feature",geometry:v(w.geometry),style:u(w.facilityT,q)}),null!=l&&k.push({type:"Feature",geometry:v(l.geometry),style:u(l.facilityT,q)}),D=0,j=k.length;j>D;D++)d=k[D],y=L.geoJson(d,{style:d.style}),null!=d._length&&(E+=d._length),null==m[q]&&(m[q]=[]),m[q].push(y),h.addLayer(y);E=(18939e-8*E).toFixed(4),E=E>1?""+E+" miles":""+E+" mile",o("div.result:eq("+q+") span.length").html(E)}s([r.lng,r.lat],g(T[0][0],T[0][1])),s([e.lng,e.lat],g(T[0][T[0].length-1],T[0][T[0].length-2])),n.prop("disabled",!1),o("div.results").removeClass("hidden")}catch(A){a=A,b("Something went wrong. Please reload the page and try again."),console.log(a)}})})},function(e){e.exports=$},function(e){e.exports=_}]);